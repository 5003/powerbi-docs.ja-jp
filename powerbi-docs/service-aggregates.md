---
title: "Power BI での集計 (合計、平均値、最大値など)"
description: "Power BI のグラフでの集計 (合計、平均値、最大値など) の変更"
services: powerbi
documentationcenter: 
author: mihart
manager: kfile
backup: 
editor: 
tags: 
qualityfocus: modifying
qualitydate: 
ms.service: powerbi
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: powerbi
ms.date: 09/23/2017
ms.author: mihart
ms.openlocfilehash: 42f9ec1dd56c2317bec07abde9822fc2b5340c07
ms.sourcegitcommit: 99cc3b9cb615c2957dde6ca908a51238f129cebb
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/13/2017
---
# <a name="aggregates-in-power-bi"></a>Power BI レポートでの集計
## <a name="what-is-an-aggregate"></a>集計とは
ある列の行の値を数学的に結合したい場合があります。 数学的演算には、合計、平均、最大、カウントなどがあります。ある列の行のデータの値を組み合わせることを集計と呼びます。 その数学的演算の結果は "*集計値*" です。 

数値フィールドの値は、合計や平均など、カテゴリ別フィールドに対して集計される値です。  たとえば、"製品別の売り上げ" や "地域別の不良品数" などです。 数値フィールドは、**メジャー** とも呼ばれます。 [フィールド] リストで、メジャーは ∑ 記号で示されます。 詳しくは、「[レポート エディター...紹介を見る](service-the-report-editor-take-a-tour.md)」をご覧ください。

*メジャー* は、実際には *計算メジャー* となることがあります。 Power BI の計算メジャーは、データと一緒にインポートされます (レポートの基となるデータ モデルで定義されます)。 それぞれの計算メジャーには、独自のハードコーディングされた式があります。 使用されている集計を変更することはできません。たとえば、合計であれば、合計のままにしかできません。 フィールドの一覧では、*計算メジャー* が計算機記号と共に表示されます。 計算メジャーの作成方法については、「[Power BI Desktop のメジャー](desktop-measures.md)」を参照してください。

カテゴリ別フィールドは数値ではありませんが、集計できます。  カテゴリ別フィールドが、**値** や **ツールチップ** のような、*数値のみ* のバケットに配置されると、Power BI では、各カテゴリの発生 (または別個の発生) を数えることができます。  文字列と日付に関しては、Power BI には、他にもいくつか集計オプションがあります。最も早い、最終、最初、最後です。  

## <a name="why-dont-aggregates-work-the-way-i-want-them-to"></a>集計が思い通りに動作しないのはなぜですか?
Power BI サービスの集計は、使い方がわかりにくいことがあります。数値フィールドがあるとき、集計を変更できないのでしょうか。 それとも、年度のようなフィールドがあるとき、集計せず、発生数だけを数えたいのでしょうか。

ほとんどの場合、問題の原因は、Power BI データセットにおけるフィールドの分類方法にあります。 フィールドがテキストとして分類されている可能性があります。その場合、合計や平均を求めることができません。 残念ながら、[フィールドの分類方法を変更できるのはデータセットのオーナーだけです](desktop-measures.md)。  

解決方法として、この記事の終わりに「**ヒントとトラブルシューティング**」という特別セクションを用意しています。  そこで回答が見つからない場合、[Power BI コミュニティ フォーラム](http://community.powerbi.com)にご質問をご投稿ください。Power BI チームが直接回答いたします。

## <a name="change-how-a-numeric-field-is-aggregated"></a>数値フィールドの集計方法の変更
売上データを地域別に合計するグラフがあるとします。これを平均を算出するグラフに変更してみましょう。 

1. レポートの編集ビューで、視覚化にメジャーを追加します。
2. [視覚化] ウィンドウでフィールドを見つけ出し、右クリックして、必要な集計の種類を選びます。 必要な集計が表示されない場合は、データセットの所有者に問い合わせてください。 所有者によるフィールドの分類方法に問題がある可能性があります。  
   
   ![](media/service-aggregates/aggregate_new.png)
   
   > [!NOTE]
   > ドロップダウンで使用できるオプションは、1) 選んだフィールドと、2) そのフィールドがデータセットの所有者によって分類された方法によって異なります。
   > 
   > 

フィールド集計に使用できる可能性のあるオプションの一部を次に示します。

* **集計しない**。 このオプションを選択すると、そのフィールド内の各値が個別に扱われ、集計されません。 これは多くの場合、合計しない数値 ID 列がある場合に使用します。
* **合計**。 このオプションを選択すると、そのフィールド内のすべての値が加算されます。
* **平均**。 値の算術平均が算出されます。
* **最小**。 最小値が示されます。
* **最大**。 最大値が示されます。
* **カウント (空白なし)**。 このオプションを選択すると、そのフィールド内の空白以外の値の数がカウントされます。
* **カウント (個別)** このオプションを選択すると、そのフィールド内の個別の値の数がカウントされます。
* **標準偏差**
* **分散**。
* **中央値**。  中央値を示します。 これは、上と下に同数の項目がある値です。  中央値が 2 つある場合、Power BI はそれらの平均値を求めます。

たとえば、次のようなデータがあるとします。

| 国 | 量 |
|:--- |:--- |
| 米国 |100 |
| 英国 |150 |
| カナダ |100 |
| ドイツ |125 |
| フランス | |
| 日本 |125 |
| オーストラリア |150 |

結果は次のようになります。

* **集計しない**: それぞれの値が個別に表示される
* **合計**: 750
* **平均**: 125
* **最大**: 150
* **最小**: 100
* **Count (Not Blanks)** (データの個数 (空白以外)): 6
* **データの個数 (個別)** : 4
* **標準偏差** : 20.4124145...
* **分散** : 416.666...
* **中央値** : 125

## <a name="use-a-non-aggregated-field-as-a-numeric-field"></a>集計されないフィールドを数値フィールドとして使用
集計されないフィールドは、数値フィールドとして使用することもできます。 たとえば、[製品名] フィールドがある場合は、それを値として追加してから、 **[カウント]** や **[個別のカウント]**に設定します。 

1. たとえば、**\[Store] \(ストア)、\[Chain] \(チェーン)** の順に選択します。
   
   ![](media/service-aggregates/count-of-chain-do_not_summarize.png)
2. 集計を、既定の **[集計しない]** から **[カウント (個別)]**に変更すると、Power BI は異なるチェーンの数をカウントします。 ここでは、"Fashions Direct" と "Lindseys" の 2 つがあります。
   
   ![](media/service-aggregates/aggregates_count.png)
3. 集計を **[カウント]**に変更すると、Power BI は合計数をカウントします。 この例では、 **Chain**に 104 個のエントリがあります。 **Chain** をフィルターとして追加すると、"Fashions Direct" に 37 行、"Lindseys" に 67 行があることを確認できます。  
   
   ![](media/service-aggregates/count_of_chain_104.png)

## <a name="tips-and-troubleshooting"></a>ヒントとトラブルシューティング
質問:  **[集計しない]** オプションが表示されないのはなぜですか?

回答:  選択しているフィールドが計算メジャーの可能性があります。 それぞれの計算メジャーには、独自のハードコーディングされた式があります。 計算を変更することはできません。

質問:  フィールドは**数値**ですが、選択肢が **[カウント]** と **[個別のカウント]** だけなのはなぜですか?

回答:  考えられる説明としては、データセットのオーナーが意図的に、あるいは意図せずフィールドを数値として*分類していません*。 たとえば、データセットに**年**フィールドがある場合、**年**フィールドは合計や平均化ではなくカウントされる (たとえば、1974 年に生まれた人の数) ことの方が多いため、データセットの所有者がテキストとして分類している可能性があります。 オーナーであれば、Power BI Desktop でデータセットを開き、**[モデリング]** タブでデータ型を変更できます。  

回答:  別の可能性としては、フィールドが*バケット*に配置されています。その場合、カテゴリ値のみが許可されます。  選択肢は、カウントと個別のカウントだけになります。

回答:  3 つ目の可能性としては、軸に対してフィールドを使用しています。 たとえば、Power BI では、棒グラフの軸で、個別の値ごとに棒が 1 本表示されます。フィールド値はまったく集計されません。 注記: このルールの例外は散布図です。X 軸と Y 軸に集計値が*要求されます*。

質問:  散布図がありますが、*集計したくありません*。  どうすれば集計しないようにできますか?

回答:  フィールドを X 軸バケットまたは Y 軸バケットではなく**詳細**バケットに追加してください。

質問:  視覚エフェクトに数値フィールドを追加すると、ほとんどは初期設定で合計になりますが、平均、カウント、またはその他の集計になるものもあります。  既定の集計が常に同じではないのはなぜですか?

回答:  データセット オーナーは、フィールドごとに既定の集計を設定できます。 データセット オーナーであれば、Power BI Desktop の **[モデリング]** タブで既定の集計を変更できます。

質問:  フィールドが**数値**ですが、ドロップダウンに集計オプションが表示されないのはなぜですか?

回答:  フィールドに計算機アイコンが付いている場合、そのフィールドは*計算メジャー*です。計算メジャーには独自のハードコーディングされた式があり、Power BI サービスでは変更できません。 使用される計算は平均や合計のような単純な集計の場合もあれば、"親カテゴリに対する貢献の割合" や "年度開始から現在までの合計" のような複雑になる場合もあります。 Power BI では、結果の合計または平均は求められず、代わりに (ハード コーディングされた式を利用して) データ ポイントごとに再計算が行われます。

質問:  私はデータセット オーナーです。フィールドが絶対に集計されないようにしたいのですが。

回答:  Power BI Desktop の **[モデリング]** タブで、**[データ型]** を **[テキスト]** に設定します。

質問:  ドロップダウンの選択肢に **[集計しない]** が表示されません。

回答:  フィールドを削除し、もう一度追加してみてください。

他にわからないことがある場合は、 [Power BI コミュニティを利用してください](http://community.powerbi.com/)。

