---
title: "Power BI Desktop でのマトリックス ビジュアルの使用"
description: "Power BI Desktop でマトリックス ビジュアルを使用して、ステップのレイアウトと詳細の強調表示を有効にする方法について説明します。"
services: powerbi
documentationcenter: 
author: davidiseminger
manager: kfile
backup: 
editor: 
tags: 
qualityfocus: no
qualitydate: 
ms.service: powerbi
ms.devlang: NA
ms.topic: article
ms.tgt_pltfrm: NA
ms.workload: powerbi
ms.date: 10/05/2017
ms.author: davidi
ms.openlocfilehash: 23be6fdb45572e6f47220bba666637757b7f4862
ms.sourcegitcommit: 284b09d579d601e754a05fba2a4025723724f8eb
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 11/15/2017
---
# <a name="use-the-matrix-visual-in-power-bi-desktop"></a>Power BI Desktop でのマトリックス ビジュアルの使用
**マトリックス** ビジュアルを使って、**Power BI Desktop** レポートでマトリックス ビジュアル ( *テーブル* ともいう) を作成し、他のビジュアルでマトリックス内の要素をクロス強調表示することができます。 また、行、列、さらには個々のセルを選択して、クロス強調表示することができます。 最終的に、レイアウト スペースをより有効に利用するために、マトリックス ビジュアルでは階段状レイアウトがサポートされます。

![](media/desktop-matrix-visual/matrix-visual_2a.png)

マトリックスに関連付けられている機能は多数あります。この記事の以下のセクションでそれらの機能について説明します。

> [!NOTE]
> **Power BI Desktop** の 2017 年 7 月のリリース以降、新しいマトリックス ビジュアルおよびテーブル ビジュアルには、適用された**レポートのテーマ**からのスタイル設定 (色を含む) が反映されます。 マトリックス ビジュアルについては目的の色にならない可能性がありますが、**[レポートのテーマ]** 構成で変更することができます。 テーマの詳細については、[**「Power BI Desktop でレポートのテーマを使用する」**](desktop-report-themes.md) をご覧ください。
> 
> 

## <a name="using-drill-down-with-the-matrix-visual"></a>マトリックス ビジュアルでドリルダウンを使用する
**マトリックス** ビジュアルを使って、これまで使用できなかった興味深いさまざまなドリルダウン操作を行うことができます。 また、行、列、さらには個々のセクションやセルを使用して、ドリルダウンすることもできます。 これらのそれぞれのしくみを見てましょう。

### <a name="drill-down-on-row-headers"></a>行ヘッダーでのドリルダウン
**[視覚化]** ウィンドウで、**[フィールド]** の **[行]** セクションに複数のフィールドを追加する場合は、マトリックス ビジュアルの行のドリルダウンを有効にします。 これは階層の作成と似ています。これにより、その階層からドリルダウン (およびバックアップ) して、各レベルのデータを分析できます。

次の図の **[行]** セクションには、*[Category]* (カテゴリ) と *[SubCategory]* (サブカテゴリ) が含まれています。ドリルスルーできる行でグループ (または階層) を作成します。

![](media/desktop-matrix-visual/matrix-visual_4.png)

ビジュアルの **[行]** セクションに作成されたグループがある場合、ビジュアル自体の左上隅に *ドリル*  アイコンと *展開* アイコンが表示されます。

![](media/desktop-matrix-visual/matrix-visual_5.png)

他のビジュアルのドリルと展開の動作と同じように、そのボタンを選択すると、階層をドリルダウン (またはバックアップ) できます。 この場合、次の図のように、*[Category]* (カテゴリ) から *[SubCategory]* (サブカテゴリ) までドリルダウンできます。ここでは、ドリルダウンの 1 つのレベル アイコン (熊手) が選択されています。

![](media/desktop-matrix-visual/matrix-visual_6.png)

これらのアイコンを使用する代わりに、行ヘッダーのいずれかを右クリックし、表示されるメニューから選択してドリルダウンすることもできます。

![](media/desktop-matrix-visual/matrix-visual_7.png)

表示されるメニューから選択できるオプションはいくつかあり、次のように結果がそれぞれ異なることに注意してください。

**[ドリルダウン]** を選択すると、 *その* 行レベルのマトリックスが展開されます。右クリックした行ヘッダー以外の他のすべての行見出しは *除外* されます。 次の図では、 *Computers* を右クリックし、 **[ドリルダウン]** を選択しています。 マトリックスに他のトップレベルの行が表示されなくなっていることに注意してください。 これは便利な機能です。**クロス強調表示**セクションを表示する場合に特に有効です。

![](media/desktop-matrix-visual/matrix-visual_8.png)

**[ドリルアップ]** アイコンをクリックすると、前のトップレベル ビューに戻ることができます。 その後、右クリック メニューから *[次のレベルを表示する]* を選択した場合、次のレベルの項目 (この例の場合は、**[SubCategory]** (サブカテゴリ) フィールド) がすべてアルファベット順にリストされます。高レベルの階層カテゴリはありません。

![](media/desktop-matrix-visual/matrix-visual_8a.png)

左上隅にある **[ドリルアップ]** アイコンをクリックし、トップレベルのカテゴリをすべてマトリックスで表示する場合は、もう一度右クリックして、**[次のレベルに展開]** を選択します。結果は次のようになります。

![](media/desktop-matrix-visual/matrix-visual_9.png)

**[含める]** および **[含めない]** のメニュー項目を使用して、マトリックスから右クリックした行 (およびすべてのサブカテゴリ) を維持 (またはそれぞれ削除) することもできます。

### <a name="drill-down-on-column-headers"></a>列ヘッダーでのドリルダウン
行でのドリルダウンの場合と同じように、**列**でドリルダウンすることもできます。 次の図の **[列]** フィールドには 2 つのフィールドがあります。この記事で前述した行の場合と同じように階層を作成します。 **[列]** フィールドには、*[Class]* (クラス) と *[Color]* (色) があります。

![](media/desktop-matrix-visual/matrix-visual_10.png)

**マトリックス** ビジュアルでは、列を右クリックすると、ドリルダウン オプションが表示されます。 次の図では、*Deluxe* を右クリックし、**[ドリルダウン]** を選択しています。

![](media/desktop-matrix-visual/matrix-visual_11.png)

**[ドリルダウン]** を選択すると、*Deluxe* の列階層の次のレベルが表示されます。この例の場合は、*[Color]* (色) です。

![](media/desktop-matrix-visual/matrix-visual_12.png)

列の他の右クリック メニュー項目は、行の場合と同じように動作します (前述の「**行ヘッダーでのドリルダウン**」を参照)。 行の場合と同じように、列に対して **[次のレベルを表示する]**、**[次のレベルに展開]**、**[含める]**、または **[含めない]** を実行することができます。

> [!NOTE]
> マトリックス ビジュアルの左上にあるドリルダウンとドリルアップのアイコンは行にのみ適用されます。 列でドリルダウンするには、右クリック メニューを使用する必要があります。
> 
> 

## <a name="stepped-layout-with-matrix-visuals"></a>マトリックス ビジュアルでの階段状レイアウト
**マトリックス** ビジュアルでは、階層の各親の下にサブカテゴリが自動的にインデントされます。これを**階段状レイアウト**といいます。

*元の* バージョンのマトリックス ビジュアルでは、サブカテゴリはまったく別の列に表示され、ビジュアルのかなり多くのスペースを占めていました。 次の図には元の**マトリックス** ビジュアルのテーブルが表示されています。サブカテゴリは完全に別の列にあることに注意してください。

![](media/desktop-matrix-visual/matrix-visual_14.png)

次の図では、**マトリックス** ビジュアルが表示されており、**階段状レイアウト**になっています。 *Computers* というカテゴリのサブカテゴリ (Computers Accessories、Desktops、Laptops、Monitors など) は若干インデントされており、ビジュアルの占有スペースがかなり小さくなっています。

![](media/desktop-matrix-visual/matrix-visual_13.png)

**階段状レイアウト**の設定は簡単に調整できます。 **マトリックス** ビジュアルを選択した状態で、**[視覚化]** ウィンドウの **[書式]** セクション (ペイント ローラーのアイコン) の **[行見出し]** セクションを展開します。 そこには **[階段状レイアウト]** トグル (オンとオフを切り替える) および **[階段状レイアウトのインデント]\**(ピクセル単位でインデント量を指定する) という 2 つのオプションがあります。

![](media/desktop-matrix-visual/matrix-visual_15.png)

**[階段状レイアウト]** をオフにすると、サブカテゴリは親カテゴリの下にインデントされず、別の列に表示されます。

## <a name="subtotals-with-matrix-visuals"></a>マトリックス ビジュアルと小計
マトリックス ビジュアルでは、行と列両方の小計をオンまたはオフにできます。 次の図では、行の小計が**オン**に設定されています。

![](media/desktop-matrix-visual/matrix-visual_20.png)

**[視覚化]** ウィンドウの **[書式]** セクションで、**[小計]** カードを展開し、**[行の小計]** スライダーを **[オフ]** にします。 このようにすると、小計が表示されなくなります。

![](media/desktop-matrix-visual/matrix-visual_21.png)

列の小計も同じ方法で変更できます。

## <a name="cross-highlighting-with-matrix-visuals"></a>マトリックス ビジュアルでのクロス強調表示
**マトリックス** ビジュアルを使って、クロス強調表示の基準としてマトリックスの要素を選ぶことができます。 **マトリックス**で列を選ぶと、レポート ページの他のビジュアルと同じように、その列が強調表示されます。 これは、他のビジュアルやデータ ポイントの選択の共通機能で、現在、**マトリックス** ビジュアルでも利用できます。

さらに、Ctrl キーを押しながらクリックすることで、クロス強調表示機能を使用することもできます。 たとえば、次の図では、一連のサブカテゴリが**マトリックス** ビジュアルから選ばれています。 ビジュアルから選ばれなかった項目は灰色表示されており、ページの他のビジュアルに、**マトリックス** ビジュアルでの選択内容がどのように反映されるかがわかります。

![](media/desktop-matrix-visual/matrix-visual_16.png)

## <a name="shading-and-font-colors-with-matrix-visuals"></a>マトリックス ビジュアルでの網掛けとフォントの色
**マトリックス** ビジュアルでは、**条件付き書式** (色、網掛け) をマトリックス内のセルの背景に適用したり、テキストや値自体に条件付き書式を適用したりできます。

条件付き書式を適用するには、マトリックス ビジュアルを選んで次のいずれかを行います。

* **[フィールド]** ウィンドウで、フィールドを右クリックして、メニューから **[条件付き書式]** を選びます。
  
  ![](media/desktop-matrix-visual/matrix-visual_17.png)
* または、**[書式]** ウィンドウで **[条件付き書式]** カードを展開し、**[バックグラウンドのカラー スケール]** または **[フォントのカラー スケール]** のスライダーを **[オン]** にします。 どちらかをオンにすると表示される *[詳細コントロール]* リンクをクリックして、色および色書式の値をカスタマイズすることができます。
  
  ![](media/desktop-matrix-visual/matrix-visual_18.png)

どちらの方法でも結果は同じです。 *[詳細コントロール]* を選ぶと次のダイアログ ボックスが表示され、調整を行うことができます。

![](media/desktop-matrix-visual/matrix-visual_19.png)

## <a name="limitations-and-considerations"></a>制限事項と考慮事項
このリリースの**マトリックス** ビジュアルには、注意すべきいくつかの制限事項と考慮事項があります。

* 列でのドリルダウンは、右クリック メニューを使用する場合にのみ実行できます。現時点では、ビジュアルで行や列のグループをドリルダウンできるかどうかは示されていません。
* 一度に展開できるのは、1 つのカテゴリではなく、レベル内のすべての項目のみです。
* 列ヘッダーを右クリックしたときにメニューに **[レコードの確認]** と表示される場合がありますが、これは機能していません。
* 現時点では、*[総計]* 行はありません。
* 階段状レイアウトで小計行をオフにしても効果はありません。
* 内部グループのテキストが外部グループより短い場合、列ヘッダーが切り捨てられる可能性があります。
* 階段状レイアウトのインデントを変更して最外部行グループのインデントをインデントしないでください。

皆様のご意見を是非お聞かせください。 現在、この**マトリックス** ビジュアルに関する**調査**を行っております。お時間があれば、[調査にご参加ください](https://www.instant.ly/s/PYXT1)。

